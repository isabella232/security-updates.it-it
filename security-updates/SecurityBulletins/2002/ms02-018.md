---
TOCTitle: 'MS02-018'
Title: 'Bollettino Microsoft sulla sicurezza MS02-018 - Critico'
ms:assetid: 'ms02-018'
ms:contentKeyID: 61239881
ms:mtpsurl: 'https://technet.microsoft.com/it-IT/library/ms02-018(v=Security.10)'
author: SharonSears
ms.author: SharonSears
---

Security Bulletin

Bollettino Microsoft sulla sicurezza MS02-018 - Critico
=======================================================

Patch cumulativa per Internet Information Services (Q319733)
------------------------------------------------------------

Data di pubblicazione: mercoledì 10 aprile 2002 | Aggiornamento: venerdì 28 febbraio 2003

**Data di pubblicazione:** 10 aprile 2002

#### Sommario

**Target del comunicato:**
clienti che eseguono hosting di server Web in sistemi Microsoft Windows NT 4.0, Windows 2000 o Windows XP.

**Impatto della vulnerabilità:**
sono state individuate dieci nuove vulnerabilità, la più grave delle quali può consentire l'esecuzione di codice sul server da parte di utenti non autorizzati. sono state individuate dieci nuove vulnerabilità, la più grave delle quali può consentire l'esecuzione di codice sul server da parte di utenti non autorizzati..

**Indicazioni:**
l'installazione della patch è vivamente consigliata a tutti gli utenti dei prodotti interessati dal problema..

**Classificazione della gravità**: critica

**Software interessati:**

-   Microsoft Internet Information Server 4.0
-   Microsoft Internet Information Services 5.0
-   Microsoft Internet Information Services 5.1

**Note:** le versioni Beta di .NET Server successive alla Build 3605 contengono le correzioni per tutte le vulnerabilità relative a IIS 6.0. Come indicato nelle domande frequenti, Microsoft sta collaborando direttamente con i pochi clienti che utilizzano la versione Beta di .NET Server in ambienti di produzione per una tempestiva risoluzione dei problemi..

### Informazioni generali

Dettagli tecnici
----------------

<span></span>
**Descrizione tecnica:**

Questa è una patch cumulativa che comprende le funzionalità di tutte le patch di protezione rilasciate per IIS 4.0, a partire da Windows NT 4.0 [Service Pack 6a](http://www.microsoft.com/ntserver/nts/downloads/recommended/sp6/allsp6.asp), e di tutte quelle rilasciate finora per IIS 5.0 e 5.1. La sezione "Ulteriori informazioni sulla patch" contiene l'elenco completo delle patch sostituite dalla presente. Prima di applicare la patch, l'amministratore del sistema deve prendere visione dei problemi descritti in tale sezione.

Oltre a includere le patch di protezione rilasciate in precedenza, questa patch permette di risolvere i seguenti problemi di protezione di IIS 4.0, 5.0 e/o 5.1, rilevati di recente::

-   Una vulnerabilità di sovraccarico del buffer riguardante il funzionamento del meccanismo di trasferimento della codifica Chunked attraverso Active Server Pages (ASP), rilevata in IIS 4.0 e 5.0. Un utente che riuscisse a sfruttare questa vulnerabilità potrebbe sovraccaricare la memoria heap del sistema, allo scopo di interrompere il servizio IIS o di consentire l'esecuzione di codice sul server.
-   Una vulnerabilità scoperta da Microsoft, correlata alla precedente ma situata in un altro punto del meccanismo di trasferimento dei dati ASP e che potrebbe essere sfruttata per lo stesso scopo e in maniera analoga. Riguarda, tuttavia, IIS 4.0, 5.0 e 5.1..
-   Un sovraccarico del buffer legato alla modalità con cui IIS 4.0, 5.0 e 5.1 elaborano le informazioni delle intestazioni HTTP in determinate situazioni. Prima di analizzare i campi delle intestazioni HTTP, IIS esegue un controllo di protezione per verificare che i campi di delimitazione previsti siano presenti e che si trovino nelle posizioni appropriate. È tuttavia possibile eludere il controllo inducendo IIS a ritenere che i delimitatori siano presenti anche quando non lo sono. Sfruttando questo difetto, un utente non autorizzato potrebbe creare un URL in cui i valori dei campi dell'intestazione HTTP potrebbero produrre un sovraccarico del buffer utilizzato per elaborarli.
-   Una vulnerabilità, scoperta da Microsoft in IIS 4.0, 5.0 e 5.1, che deriva da un errore nel controllo di protezione eseguito durante le inclusioni lato server. In alcuni casi, per soddisfare correttamente una richiesta utente relativa alla visualizzazione di una pagina Web, è necessario includere il file in uno script ASP ed elaborarlo. Prima di elaborare la richiesta di inclusione, IIS esegue un'operazione sul nome del file specificato dall'utente, per verificare che sia valido e di dimensione tale da consentirne l'inserimento in un buffer statico. In alcuni casi, tuttavia, è possibile specificare un nome di file fittizio estremamente lungo, riuscendo comunque a superare il controllo di protezione e producendo un sovraccarico del buffer.
-   Un sovraccarico del buffer nell'estensione ISAPI HTR di IIS 4.0 e 5.0. Inviando una serie di richieste HTR alterate in modo particolare, è possibile provocare l'interruzione del servizio IIS o, in circostanze molto specifiche, provocare l'esecuzione di codice sul server..
-   Una vulnerabilità DoS (Denial of Service) riguardante la modalità con cui IIS 4.0, 5.0 e 5.1 gestiscono le condizioni di errore provenienti dai filtri ISAPI. Almeno uno dei filtri ISAPI forniti con ASP .NET e con le estensioni del server di FrontPage genera un errore quando riceve una richiesta contenente un URL che supera la lunghezza massima impostata per il filtro. Durante l'elaborazione dell'errore, il filtro sostituisce l'URL con un valore Null. Poiché IIS tenta di elaborare l'URL mentre restituisce il messaggio di errore al richiedente, si verifica una violazione di accesso che provoca l'interruzione del servizio IIS..
-   Una vulnerabilità DoS (Denial of Service) riguardante la modalità con cui il servizio FTP di IIS 4.0, 5.0 e 5.1 gestisce le richieste di stato della sessione FTP corrente. Se un utente non autorizzato riuscisse ad aprire una sessione FTP presso un server affetto da questo problema e inviasse una richiesta di stato in grado di creare una particolare condizione di errore, quest'ultima non verrebbe riportata correttamente, a causa di un difetto del codice FTP. Un'altra sezione del codice del servizio FTP tenterebbe quindi di utilizzare dati non inizializzati, dando luogo a una violazione di accesso. Oltre all'interruzione dei servizi FTP, questo provocherebbe anche quella dei servizi Web.
-   Tre vulnerabilità Cross-Site (CSS) Scripting riguardanti IIS 4.0, 5.0 e 5.1. La prima riguarda la pagina dei risultati restituita dalla funzione di ricerca dei file della documentazione in linea di IIS, la seconda riguarda le pagine di errore HTTP e la terza il messaggio di errore restituito per segnalare che l'URL richiesto è stato reindirizzato. Tutte queste vulnerabilità hanno la stessa natura e lo stesso effetto: un utente che venisse indotto a fare clic su un collegamento di un sito Web creato da un malintenzionato potrebbe inviare una richiesta contenente uno script a un sito Web IIS di terze parti, che restituirebbe all'utente una risposta contenente il medesimo script. Tale script verrebbe quindi eseguito con le impostazioni di protezione del sito di terze parti, anziché con quelle dell'aggressore.

**Fattori attenuanti:**

Sovraccarico del buffer nel trasferimento della codifica Chunked:

-   Nelle installazioni predefinite di IIS 5.0 e 5.1, lo sfruttamento della vulnerabilità per l'esecuzione di codice può concedere a un utente non autorizzato i privilegi dell'account IWAM\_nomecomputer, equivalenti a quelli di un utente senza privilegi connesso tramite un accesso interattivo.
-   Per sfruttare la vulnerabilità è necessario che nel sistema siano attivate le funzionalità ASP (Active Server Pages). Con la versione 1.0 di IIS Lockdown Tool le funzionalità ASP vengono disattivate per impostazione predefinita, mentre con la versione corrente (2.1) vengono disattivate selezionando l'opzione Server Web statico.
-   È possibile configurare lo strumento [URLScan](http://www.microsoft.com/technet/security/tools/tools/urlscan.mspx) in modo da impedire le richieste di codifica Chunked. Se si prendono queste precauzioni, la vulnerabilità non può essere sfruttata.

Variante scoperta da Microsoft di sovraccarico del buffer nella codifica Chunked:

-   Questa vulnerabilità è soggetta agli stessi fattori attenuanti del sovraccarico del buffer nel trasferimento della codifica Chunked ad eccezione dello strumento URLScan, che infatti non può essere utilizzato come metodo di protezione.

Sovraccarico del buffer nella gestione delle intestazioni HTTP:

-   Nelle installazioni predefinite di IIS 5.0 e 5.1, lo sfruttamento della vulnerabilità per l'esecuzione di codice può concedere a un utente non autorizzato i privilegi dell'account IWAM\_nomecomputer, equivalenti a quelli di un utente senza privilegi connesso tramite un accesso interattivo.
-   Per sfruttare la vulnerabilità è necessario che nel sistema siano attivate le funzionalità ASP (Active Server Pages). Con la versione 1.0 di IIS Lockdown Tool le funzionalità ASP vengono disattivate per impostazione predefinita, mentre con la versione corrente (2.1) vengono disattivate selezionando l'opzione Server Web statico.
-   L'insieme di regole predefinite dello strumento [URLScan](http://www.microsoft.com/technet/security/tools/tools/urlscan.mspx) può limitare i danni causati dallo sfruttamento della vulnerabilità all'esecuzione di attacchi DoS (Denial of Service).

Sovraccarico del buffer nella funzione ASP di inclusione lato server:

-   Nelle installazioni predefinite di IIS 5.0 e 5.1, lo sfruttamento della vulnerabilità per l'esecuzione di codice può concedere a un utente non autorizzato i privilegi dell'account IWAM\_nomecomputer, equivalenti a quelli di un utente connesso tramite un accesso interattivo.
-   Per sfruttare la vulnerabilità è necessario che nel sistema siano attivate le funzionalità ASP (Active Server Pages). Con la versione 1.0 di IIS Lockdown Tool le funzionalità ASP vengono disattivate per impostazione predefinita, mentre con la versione corrente (2.1) vengono disattivate selezionando l'opzione Server Web statico.
-   L'insieme di regole predefinite dello strumento [URLScan](http://www.microsoft.com/technet/security/tools/tools/urlscan.mspx)può limitare i danni causati dallo sfruttamento della vulnerabilità all'esecuzione di attacchi DoS (Denial of Service).

Sovraccarico del buffer nell'estensione ISAPI HTR:

-   Si consiglia di disattivare l'estensione ISAPI HTR. Nei sistemi che adottano questa precauzione, non è possibile sfruttare la vulnerabilità in questione (il supporto di HTR è disattivato per impostazione predefinita in tutte le versioni di IIS Lockdown Tool).
-   Se si utilizza l'insieme di regole predefinito, lo strumento [URLScan](http://www.microsoft.com/technet/security/tools/tools/urlscan.mspx)impedisce di sfruttare questa vulnerabilità per eseguire codice sul server, anche se il supporto di HTR è attivo.
-   Un utente non autorizzato può sfruttare questa vulnerabilità per eseguire codice sul server solo se conosce le posizioni di memoria di determinate informazioni. La probabilità che questa situazione si verifichi è massima se il server Web non ha ancora fornito alcun contenuto Web dal momento del riavvio. In tutti gli altri casi, è possibile sfruttare la vulnerabilità solo per attacchi DoS (Denial of Service).
-   Nelle installazioni predefinite di IIS 5.0 e 5.1, lo sfruttamento della vulnerabilità per l'esecuzione di codice può concedere a un utente non autorizzato i privilegi dell'account IWAM\_nomecomputer, equivalenti a quelli di un utente connesso tramite un accesso interattivo.
-   Se la vulnerabilità viene sfruttata per un attacco DoS, in IIS 4.0 è possibile ripristinare il normale funzionamento del server riavviando il servizio IIS. In IIS 5.0 e versioni successive, il servizio viene riavviato automaticamente.

Violazione di accesso nella gestione degli errori URL:

-   In un server IIS 4.0 è possibile ripristinare il normale funzionamento riavviando il servizio. In IIS 5.0 o 5.1 il servizio viene riavviato automaticamente.
-   La vulnerabilità può essere sfruttata soltanto per attacchi DoS (Denial of Service): non è possibile utilizzarla per acquisire privilegi sul sistema.
-   L'unico filtro ISAPI in grado di generare l'errore che provoca la violazione di accesso viene fornito all'interno delle estensioni del server di FrontPage e di ASP .NET. Le estensioni del server di FrontPage possono essere disinstallate in qualsiasi momento e ASP .NET non viene installato per impostazione predefinita.

Attacchi DoS tramite richieste di stato FTP

-   IIS Lockdown Tool disattiva il supporto FTP per impostazione predefinita.
-   In un server IIS 4.0 è possibile ripristinare il normale funzionamento riavviando il servizio. In IIS 5.0 o 5.1 il servizio viene riavviato automaticamente.
-   La vulnerabilità può essere sfruttata soltanto per attacchi DoS (Denial of Service): Non è possibile utilizzarla per acquisire privilegi sul sistema.

Cross-site scripting della funzione di ricerca dei file della documentazione in linea di IIS, delle pagine di errore HTTP e dei messaggi di reindirizzamento.

-   Queste vulnerabilità possono essere sfruttate solo se l'aggressore riesce a indurre un utente a visitare una determinata pagina Web e a fare clic su uno dei collegamenti contenuti oppure ad aprire un messaggio di posta elettronica HTML.
-   La vulnerabilità riguardante i messaggi di reindirizzamento può essere sfruttata solo se l'utente utilizza un browser diverso da Internet Explorer. Internet Explorer non visualizza il testo del messaggio di reindirizzamento, ma lo riconosce dall'intestazione ed esegue il reindirizzamento senza visualizzare alcun messaggio.

**Classificazione della gravità**

Sovraccarico del buffer nel meccanismo di trasferimento dati della codifica Chunked ASP:

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | Critico          | Critico          | No             |
| **IIS 5.0** | Critico          | Critico          | No             |
| **IIS 5.1** | No               | No               | No             |

Variante scoperta da Microsoft di sovraccarico del buffer nella codifica Chunked ASP

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | Critico          | Critico          | No             |
| **IIS 5.0** | Critico          | Critico          | No             |
| **IIS 5.1** | Critico          | Critico          | No             |

Sovraccarico del buffer nella gestione delle intestazioni HTTP:

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | Critico          | Critico          | No             |
| **IIS 5.0** | Critico          | Critico          | No             |
| **IIS 5.1** | Critico          | Critico          | No             |

Sovraccarico del buffer nella funzione ASP di inclusione lato server:

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | Critico          | Critico          | No             |
| **IIS 5.0** | Critico          | Critico          | No             |
| **IIS 5.1** | Critico          | Critico          | No             |

Sovraccarico del buffer nell'estensione ISAPI HTR:

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | Moderato         | Moderato         | No             |
| **IIS 5.0** | Moderato         | Moderato         | No             |
| **IIS 5.1** | No               | No               | No             |

Violazione di accesso nella gestione degli errori URL:

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | Moderato         | Moderato         | No             |
| **IIS 5.0** | Moderato         | Moderato         | No             |
| **IIS 5.1** | Moderato         | Moderato         | No             |

Attacchi DoS tramite richieste di stato FTP:

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | Moderato         | Moderato         | No             |
| **IIS 5.0** | Moderato         | Moderato         | No             |
| **IIS 5.1** | Moderato         | Moderato         | No             |

Cross-site scripting nella funzionalità di ricerca della documentazione in linea di IIS:

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | No               | No               | Moderato       |
| **IIS 5.0** | No               | No               | Moderato       |
| **IIS 5.1** | No               | No               | Moderato       |

Cross-site scripting nella pagina di errore HTTP:

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | No               | No               | Moderato       |
| **IIS 5.0** | No               | No               | Moderato       |
| **IIS 5.1** | No               | No               | Moderato       |

Cross-site scripting nella pagina di errore HTTP:

|             | Internet Servers | Intranet Servers | Client Systems |
|-------------|------------------|------------------|----------------|
| **IIS 4.0** | No               | No               | Low            |
| **IIS 5.0** | No               | No               | Low            |
| **IIS 5.1** | No               | No               | Low            |

La valutazione riportata sopra si basa sui tipi di sistemi affetti dalla vulnerabilità, sui relativi modelli di distribuzione tipici e sull'effetto che lo sfruttamento della vulnerabilità potrebbe produrre.

**Identificatori di vulnerabilità**

-   Sovraccarico del buffer nel meccanismo di codifica Chunked: [CAN-2002-0079](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0079)
-   Variante scoperta da Microsoft di sovraccarico del buffer nella codifica Chunked: [CAN-2002-0147](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0147)
-   Sovraccarico del buffer nella gestione delle intestazioni HTTP: [CAN-2002-0150](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0150)
-   Sovraccarico del buffer nella funzione ASP di inclusione lato server: [CAN-2002-0149](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0149)
-   Sovraccarico del buffer nell'estensione ISAPI HTR: [CAN-2002-0071](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0071)
-   Violazione di accesso nella gestione degli errori URL: [CAN-2002-0072](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0072)
-   Attacchi DoS tramite richieste di stato FTP: [CAN-2002-0073](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0073)
-   Cross-site scripting nella funzionalità di ricerca della documentazione in linea di IIS: [CAN-2002-0074](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0074)
-   Cross-site scripting nella pagina di errore HTTP: [CAN-2002-0148](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0148)
-   Cross-site scripting nel messaggio di reindirizzamento: [CAN-2002-0075](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0075)

**Versioni testate:**

Nella tabella che segue sono indicate le versioni di IIS attualmente supportate e interessate dalle vulnerabilità. Poiché le versioni di IIS precedenti la 4.0 non sono più supportate, in tali versioni l'esistenza di queste vulnerabilità non è stata verificata. Ancora in fase Beta, IIS 6.0 è stato adottato in ambienti di produzione solo da un ristretto gruppo di clienti, nell'ambito di un programma gestito in collaborazione con Microsoft. Le patch necessarie verranno pertanto fornite solo ai diretti interessati.

|                                                                                         | IIS 4.0 | IIS 5.0 | IIS 5.1 |
|-----------------------------------------------------------------------------------------|---------|---------|---------|
| **Sovraccarico del buffer nel meccanismo di codifica Chunked**                          | Si      | Si      | No      |
| **Variante scoperta da Microsoft di sovraccarico del buffer nella codifica Chunked**    | Si      | Si      | Si      |
| **Sovraccarico del buffer nella gestione delle intestazioni HTTP**                      | Si      | Si      | Si      |
| **Sovraccarico del buffer nella funzione ASP di inclusione lato server**                | Si      | Si      | Si      |
| **Sovraccarico del buffer nell'estensione ISAPI HTR**                                   | Si      | Si      | No      |
| **Violazione di accesso nella gestione degli errori URL**                               | Si      | Si      | Si      |
| **Attacchi DoS tramite richieste di stato FTP**                                         | Si      | Si      | Si      |
| Cross-site scripting nella funzionalità di ricerca della documentazione in linea di IIS | No      | Si      | Si      |
| **Cross-site scripting nella pagina di errore HTTP**                                    | Si      | Si      | Si      |
| **Cross-site scripting nel messaggio di reindirizzamento**                              | Si      | Si      | Si      |

Domande frequenti
-----------------

<span></span>
**Quali vulnerabilità è possibile eliminare con questa patch?**
Questa è una patch cumulativa che, una volta applicata, elimina la maggior parte delle vulnerabilità di protezione di Internet Information Server 4.0 (le eccezioni sono elencate nella sezione "Attenzione") e tutte quelle di Internet Information Services 5.0 e 5.1. Oltre alle vulnerabilità descritte in precedenza, questa patch permette di eliminare anche molte di quelle scoperte di recente:

-   Una [vulnerabilità](http://www.microsoft.com/italy/technet/solutions/security/ms02_018.asp) che può consentire a un utente non autorizzato di ottenere il controllo di un server Web che esegue IIS 4.0 o 5.0.
-   Una[vulnerabilità](http://www.microsoft.com/italy/technet/solutions/security/ms02_018.asp) scoperta da Microsoft, che comporta gli stessi rischi ed effetti della precedente, ma che interessa IIS 4.0, 5.0 e 5.1.
-   Una [vulnerabilità](http://www.microsoft.com/italy/technet/solutions/security/ms02_018.asp) che può consentire a un utente non autorizzato di ottenere il controllo di un server Web che esegue IIS 4.0 o 5.0.
-   Una [vulnerabilità](http://www.microsoft.com/italy/technet/solutions/security/ms02_018.asp) scoperta da Microsoft, che può consentire a un utente non autorizzato di ottenere il controllo di un server Web che esegue IIS 4.0, 5.0 o 5.1.
-   Una [vulnerabilità](http://www.microsoft.com/italy/technet/solutions/security/ms02_018.asp) che in determinate condizioni può consentire a un utente non autorizzato di ottenere il controllo di un server Web che esegue IIS 4.0 o 5.0.
-   Una [vulnerabilità](http://www.microsoft.com/italy/technet/solutions/security/ms02_018.asp) che può consentire a un utente non autorizzato di impedire a un server Web IIS 4.0, 5.0 o 5.1 di fornire i propri servizi.
-   Una [vulnerabilità](http://www.microsoft.com/italy/technet/solutions/security/ms02_018.asp) che può consentire a un utente non autorizzato di impedire a un server FTP IIS 4.0, 5,0 o 5,1 di fornire i propri servizi.
-   Tre [vulnerabilità](http://www.microsoft.com/italy/technet/solutions/security/ms02_018.asp) che possono consentire a un utente non autorizzato di inviare contenuto Web alla sessione browser di un altro utente, attraverso un server Web IIS 4.0, 5.0 o 5.1.

**Con quali prodotti vengono forniti IIS 4.0, 5.0 e 5.1?**

-   Internet Information Server 4.0 fa parte di Windows NT 4.0 Option Pack (NTOP).
-   Internet Information Service 5.0 fa parte di Windows 2000 Server, Professional, Datacenter Server e Advanced Server.
-   Internet Information Service 5.1 fa parte di Windows XP Professional. Non viene invece fornito in Windows XP Home Edition.

**IIS 4.0, 5.0 e 5.1 vengono eseguiti per impostazione predefinita?**

-   IIS 4.0 viene eseguito per impostazione predefinita nei server Windows NT 4.0 in cui è installato Windows NT 4.0 Option Pack. Se Windows NT 4.0 Option Pack viene installato in Windows NT 4.0 Workstation, viene eseguito per impostazione predefinita solo se i Servizi Microsoft Peer Web erano già in esecuzione al momento dell'installazione.
-   IIS 5.0 viene eseguito per impostazione predefinita in tutti i prodotti server della famiglia Windows 2000. In Windows 2000 Professional, non viene eseguito per impostazione predefinita.
-   In Windows XP, IIS 5.1 non viene eseguito per impostazione predefinita.

**La patch contiene anche altre correzioni?**
Sì. Oltre a eliminare le vulnerabilità di protezione descritte sopra, la patch risolve anche alcuni problemi che non riguardano la sicurezza. Tali problemi sono documentati nell'articolo Q319733 della Microsoft Knowledge Base.

**Alcune vulnerabilità interessano solo determinate versioni di IIS. Come è possibile stabilire se la versione utilizzata necessita di una patch?**
Se si utilizza uno dei prodotti interessati, è opportuno installare la patch. La patch elimina solo le vulnerabilità della versione di IIS utilizzata.

**Oltre a tenersi aggiornati sulle patch, che cosa è necessario fare per garantire la protezione di un server Web?**
Per garantire la protezione di un server Web, è essenziale utilizzare IIS Lockdown Tool. Questo strumento garantisce che il server sia configurato in modo sicuro e installa lo strumento URLScan che fornisce una protezione continua mentre il server è in funzione.
Esistono inoltre alcune vulnerabilità di IIS 4.0 che non possono essere eliminate applicando patch software, ma che richiedono l'intervento dell'amministratore. Tutte queste vulnerabilità sono elencate nella sezione "Attenzione".

**È possibile installare le patch in sistemi che eseguono Personal Web Server o i Servizi Microsoft Peer Web?**
Solo in alcuni casi. Se si utilizzano i servizi Microsoft Peer Web o Personal Web Server, è possibile consultare l'articolo [Q307439](http://support.microsoft.com/directory/article.asp?id=kb;en-us;q307439) della Microsoft Knowledge Base per ottenere informazioni specifiche.

**Perché non si è parlato delle vulnerabilità di IIS 6.0?**
Nei comunicati di protezione non si fa in genere riferimento alle versioni Beta dei prodotti, che sono incomplete per definizione. Tali versioni vengono fornite solo a scopo di valutazione e non devono essere utilizzate in sistemi di produzione. Un ristretto gruppo di clienti ha adottato server IIS 6.0 in ambienti di produzione, nell'ambito di un programma gestito in collaborazione con Microsoft. Le patch necessarie verranno fornite solo ai diretti interessati.

**Sovraccarico del buffer nel trasferimento della codifica Chunked (CVE-CAN-2002-0079)**

**Qual è la natura della vulnerabilità?**
Si tratta di una vulnerabilità di [sovraccarico di buffer](http://www.microsoft.com/technet/security/bulletin/glossary.asp) che riguarda IIS 4.0 e 5.0. Inviando una particolare richiesta a un server Web, un utente non autorizzato potrebbe provocare l'interruzione di servizi Web o l'esecuzione di un programma sul server. In IIS 4.0, tale programma verrebbe eseguito con privilegi di sistema completi, mentre in IIS 5.0 verrebbe eseguito con privilegi più limitati, ma comunque significativi.
I clienti che hanno utilizzato IIS Lockdown Tool per configurare i server come server Web statici sono già protetti dalla vulnerabilità. È anche possibile configurare lo strumento URLScan in modo da bloccare la vulnerabilità e disattivare il meccanismo interessato. Tuttavia, data la gravità del problema, si consiglia di installare la patch in ogni caso, anche se sono state eseguite le operazioni descritte sopra.

**Quali sono le cause della vulnerabilità?**
Questa vulnerabilità è dovuta a un errore di calcolo dell'estensione ISAPI che implementa la funzionalità ASP (Active Server Pages). L'errore si trova in una funzione che consente di caricare i dati in un server Web per mezzo della codifica Chunked e provoca l'allocazione di un buffer di dimensione insufficiente a contenere i dati in arrivo, che possono pertanto oltrepassare la fine del buffer.

**Che cosa sono le estensioni ISAPI?**
[ISAPI](http://msdn.microsoft.com/library/en-us/iisref/html/psdk/asp/isgu80v9.asp) (Internet Services Application Programming Interface) è una tecnologia che consente agli sviluppatori Web di estendere la funzionalità dei propri server Web scrivendo il[codice personalizzato](http://msdn.microsoft.com/library/en-us/iisref/html/psdk/asp/devs5vw3.asp) che fornisce i nuovi servizi. Tale codice può essere implementato in

-   Come [filtro ISAPI](http://msdn.microsoft.com/library/en-us/iisref/html/psdk/asp/devs9qer.asp), costituito da una [libreria a collegamento dinamico](http://msdn.microsoft.com/library/en-us/dllproc/dll_512r.asp) (.dll) che utilizza ISAPI per rispondere agli eventi generati sul server.
-   Come [estensione ISAPI](http://msdn.microsoft.com/library/en-us/iisref/html/psdk/asp/devs8fsj.asp), costituita da una libreria a collegamento dinamico che utilizza ISAPI per fornire un insieme di funzioni Web non comprese in IIS.

Questa vulnerabilità interessa le estensioni ISAPI che implementano script basati su ASP.

**Che cos'è ASP?**
[Active Server Pages](http://msdn.microsoft.com/library/default.asp?url=/library/psdk/iisref/aspguide.htm) (ASP) è una tecnologia che consente ai server Web di generare applicazioni Web in modo dinamico. Le pagine ASP possono essere viste come programmi che risiedono sul server Web. Quando un utente richiede una pagina ASP, l'estensione ISAPI ASP la elabora, genera la pagina HTML corrispondente e la invia all'utente. In questo caso, la vulnerabilità non riguarda la tecnologia ASP in sé, ma sfrutta un errore nell'implementazione ASP di un'operazione standard di trasferimento dei dati, denominata codifica Chunked.

**Che cos'è la codifica Chunked?**
Molti server Web hanno l'esigenza di ricevere dati dagli utenti. Ad esempio, quando un visitatore di un sito Web compila un form e lo invia, i dati contenuti devono essere caricati sul server, dove vengono elaborati. In questi casi, poiché si conosce in anticipo la quantità dei dati da trasferire, il server può allocare un buffer di dimensione appropriata. In circostanze diverse, tuttavia, non è possibile conoscere in anticipo il volume dei dati da trasferire. Se ad esempio tali informazioni vengono generate durante l'esecuzione di un'applicazione, non è possibile conoscere in anticipo la quantità esatta dei dati prodotti.
La [specifica del protocollo HTTP](http://support.microsoft.com/default.aspx?scid=http://www.rfc-editor.org/rfc/rfc2068.txt) permette di gestire le informazioni di questo tipo mediante un processo denominato codifica Chunked. Nella codifica Chunked, il client genera una quantità di dati di dimensione variabile, detta chunk, quindi la invia al server Web dopo averne comunicato la dimensione. Il server alloca un buffer adeguato ad accogliere il chunk in arrivo, dopodiché lo riceve e lo elabora. Via via che genera nuovi dati, il client li raccoglie in chunk e li invia al server.

**In che cosa consiste l'errore nell'implementazione dei trasferimenti con codifica Chunked eseguiti in IIS 4.0 e 5.0?**
Si tratta di un errore di calcolo delle implementazioni di ASP di IIS 4.0 e 5.0, a causa del quale la dimensione del buffer utilizzato per ricevere i chunk in arrivo risulta troppo piccola. I dati dei chunk finiscono pertanto per oltrepassare la fine dei buffer, sovrascrivendo altri dati contenuti nella memoria del sistema. Questo potrebbe provocare un'alterazione del funzionamento di IIS.

**Quanti dati potrebbero essere sovrascritti?**
Il client può inviare chunk di qualsiasi dimensione. Se non è in grado di accettare un chunk perché troppo grande, il server invia al client un messaggio di errore. Oltre a provocare l'allocazione di un buffer di dimensione errata, l'errore di calcolo impedisce ad IIS 4.0 e 5.0 di imporre un limite reale alla dimensione dei chunk. Di conseguenza, il client potrebbe addirittura inviare un chunk in grado di sovrascrivere tutta o gran parte della memoria del sistema.
Questo è proprio il motivo per cui la vulnerabilità in questione costituisce un serio pericolo per i server Web. Questa vulnerabilità è un esempio di sovraccarico dell'heap. Si tratta di un problema in genere difficile o impossibile da sfruttare, a causa della natura dinamica della memoria del sistema. La posizione di memoria dei dati sul server cambia continuamente, impedendo a un eventuale aggressore di sovrascrivere programmi o dati specifici. In questo caso, tuttavia, l'aggressore non deve necessariamente sapere dove si trovano i programmi, poiché il suo scopo è semplicemente sovrascrivere indiscriminatamente gran parte della memoria del sistema.

**Quali operazioni consente di eseguire lo sfruttamento della vulnerabilità?**
Un utente che riuscisse a sfruttare la vulnerabilità potrebbe utilizzarla per due scopi.

-   Interruzione di servizi. Sovraccaricando il buffer con dati casuali, l'utente può danneggiare il codice del programma provocando l'interruzione dei servizi IIS sul server.
-   Modifica del funzionamento del server. Sovraccaricando il buffer con dati attentamente selezionati, l'utente può sovrascrivere il codice del programma sul server con del nuovo codice, modificando le funzionalità del software server.

**Chi può sfruttare la vulnerabilità?**
Qualsiasi utente in grado di stabilire una sessione Web con un server interessato dalla vulnerabilità potrebbe riuscire a sfruttarla.

**In caso di sfruttamento della vulnerabilità per l'arresto del servizio IIS, quali operazioni sono necessarie per ripristinare il normale funzionamento?**
In IIS 4.0 è necessario riavviare il servizio IIS. In IIS 5.0 il servizio viene riavviato automaticamente.

**Perché questa vulnerabilità può essere utilizzata solo per provocare l'interruzione dei servizi IIS? Se l'aggressore ha la possibilità di sovrascrivere indiscriminatamente la memoria del sistema, perché non sovrascrive tutta la memoria del server, in modo da bloccare l'intero sistema operativo?**
Windows NT 4.0, Windows 2000 e Windows XP funzionano in modalità protetta. In questa modalità, i processi possono scrivere solo nelle sezioni di memoria di cui sono proprietari. Pertanto, l'aggressore non ha la possibilità di sovrascrivere la memoria appartenente al sistema operativo.

**In caso di sfruttamento della vulnerabilità per la modifica del funzionamento del software server, quali operazioni potrebbero essere eseguite?**
In breve, il codice inviato dall'aggressore acquisisce i privilegi del software che lo ha chiamato, in questo caso l'estensione ISAPI ASP, ossia ASP.DLL. Tali privilegi dipendono dalla versione di IIS utilizzata sul server:

-   In IIS 4.0, ASP.DLL viene eseguita per impostazione predefinita come componente in-process, ossia come parte del servizio IIS, che a sua volta viene eseguito come parte del sistema operativo stesso. Di conseguenza, sfruttando questa vulnerabilità in un'installazione predefinita di IIS 4.0, un aggressore può ottenere il controllo completo del server.
-   process, ossia nel contesto di sicurezza di uno speciale account utente, di nome Web Application Manager (noto agli amministratori Web con il nome di IWAM\_nomecomputer, dove nomecomputer è il nome del server). Tale account gode di privilegi sensibilmente più limitati, rispetto al servizio IIS.

**Di quali privilegi dispone l'account Web Application Manager?**
Questo account dispone, in pratica, degli stessi privilegi degli utenti senza privilegi connessi tramite un accesso interattivo. L'aggressore non ha pertanto la possibilità di svolgere operazioni amministrative, di riconfigurare il server o di accedere a file importanti come il database del sistema di gestione degli account di protezione (SAM, Security Account Manager).
È tuttavia importante non sottovalutare i danni che possono essere provocati con i pochi privilegi disponibili, poiché possono essere significativi. Questa vulnerabilità potrebbe inoltre essere utilizzata come punto di partenza per altri attacchi, con lo scopo di ottenere maggiori privilegi.

**È possibile configurare IIS 4.0 in modo da eseguire ASP.DLL come componente out-of-process?**
Sì. Quando possibile, si consiglia di [configurare](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/iisref/html/psdk/asp/isgu24c3.asp) IIS 4.0 in modo da eseguire ASP.DLL e altri componenti in modalità out-of-process. Oltre a migliorare la protezione, questo accorgimento aumenta anche la stabilità del sistema. L'esecuzione in modalità out-of-process comporta tuttavia un calo di prestazioni.

**Se non si utilizzano pagine ASP è possibile disattivare tutte le funzionalità relative, in modo da proteggere il server?**
Sì. Nella versione 1.0 di IIS Lockdown Tool le funzionalità ASP sono disattivate per impostazione predefinita. La versione corrente dello strumento (2.1), fornisce diversi ruoli server. Selezionando l'opzione Server Web statico, le funzionalità ASP vengono disattivate per impostazione predefinita.

**L'uso dello strumento URLScan sul server protegge il sistema da questa vulnerabilità?**
Se si utilizzano le impostazioni predefinite, no. Tuttavia, è possibile aggiungere una regola che blocca le richieste di codifica Chunked. È sufficiente aggiungere alla sezione \[DenyHeaders\] del file URLScan.ini la voce "Transfer-Encoding:". Nota: nella nuova voce, non utilizzare le virgolette, ma ricordare di inserire i due punti (:) dopo la parola "Encoding".
Microsoft ha rilasciato una versione aggiornata di URLScan che fornisce un'implementazione predefinita di questa regola e offre una protezione maggiore, rispetto alla versione precedente dello strumento.

**In che modo opera la patch per eliminare la vulnerabilità?**
La patch elimina l'errore di calcolo alla base della vulnerabilità.

**Variante scoperta da Microsoft di sovraccarico del buffer nella codifica Chunked (CVE-CAN-2002-0147)**

Questa vulnerabilità è identica alla precedente, per natura, effetto e soluzione. Presenta solo due differenze significative:

-   Interessa un maggior numero di versioni di IIS. Nello specifico, interessa IIS 4.0, 5.0 e 5.1.
-   Non può essere bloccata da URLScan.

**Quali sono le cause della vulnerabilità?**
Questa vulnerabilità è dovuta a un errore di gestione che si verifica durante l'allocazione dei buffer per i trasferimenti di dati. Sebbene coinvolga funzionalità simili a quelle interessate dalla precedente e abbia lo stesso effetto globale, queste due vulnerabilità presentano tuttavia alcune differenze importanti.

**Quali sono le differenze fra questa vulnerabilità e la precedente?**
Esistono due differenze principali. Innanzitutto, questa vulnerabilità è presente anche in IIS 5.1, che non è invece interessato dalla precedente. In secondo luogo, a differenza della precedente, questa vulnerabilità, non può essere eliminata da URLScan.

**Come è stata scoperta la vulnerabilità?**
Microsoft ha scoperto questa vulnerabilità durante l'analisi del codice svolta per individuare la precedente.

**Sovraccarico del buffer nella funzione ASP di inclusione lato server (CVE-CAN-2002-0149)**

**Qual è la natura della vulnerabilità?**
Si tratta di una vulnerabilità di [sovraccarico del buffer](http://www.microsoft.com/technet/security/bulletin/glossary.asp)che riguarda IIS 4.0, 5.0 e 5.1. Inviando una particolare richiesta a un server Web, un utente non autorizzato potrebbe provocare l'interruzione di servizi Web o l'esecuzione di programmi sul server. In IIS 4.0, tale programma verrebbe eseguito con privilegi di sistema completi, mentre in IIS 5.0 e 5.1 verrebbe eseguito con privilegi più limitati, ma comunque significativi.
I clienti che hanno utilizzato IIS Lockdown Tool per configurare i server come server Web statici sono già protetti dalla vulnerabilità. Analogamente, l'uso dello strumento URLScan con l'insieme di regole predefinito impedisce di sfruttare la vulnerabilità per ottenere il controllo del server, riducendo l'attacco a un semplice attacco DoS (Denial of Service).

**Quali sono le cause della vulnerabilità?**
Questa vulnerabilità è dovuta a un errore logico contenuto in una delle funzioni che gestiscono le inclusioni lato server in ASP. A causa di questo errore, la funzione può ritenere sicura la memorizzazione del nome di un determinato file lato server in un buffer specifico, mentre, in realtà, il nome del file è più lungo del buffer.

**Che cosa sono le inclusioni lato server?**
Gli sviluppatori hanno spesso l'esigenza di incorporare file nei proprio programmi, ad esempio per riutilizzare il codice esistente. Questo è possibile mediante le inclusioni di file. Lo sviluppatore indica il file da includere nel programma e in quale posizione, e il contenuto di tale file viene gestito come se fosse parte integrante del programma.
Come la maggior parte dei linguaggi di programmazione, anche il linguaggio ASPsupporta le inclusioni di file. Poiché, nel caso di ASP, i file inclusi provengono dal server Web, si parla di inclusioni lato server. Quando si esegue uno script ASP, le inclusioni di file vengono gestite durante la fase di preelaborazione, il cui risultato viene elaborato da un filtro ISAPI ASP.

**Il visitatore di un sito Web può richiedere un'inclusione lato server?**
No. I visitatori dei siti Web non vengono mai coinvolti nel funzionamento degli script ASP, poiché l'elaborazione avviene interamente sul server. Tuttavia, è possibile che l'utente esegua azioni che hanno l'effetto di provocare un'inclusione di file sul server. In tale situazione, questa vulnerabilità influisce in un modo particolare sul funzionamento di IIS.

**Qual è il problema legato alla modalità con cui IIS gestisce le inclusioni lato server?**
In alcuni casi, quando viene richiesta una pagina Web specifica, quest'ultima viene inclusa in uno script ASP, durante la sua elaborazione. Poiché, per questo scopo, è necessario inserire in un buffer l'input dell'utente, IIS esegue sempre un controllo preventivo, per garantire la validità di tale input. In particolare, esegue un'operazione che ha esito positivo solo se il nome del file è valido. .
Questo può dare luogo a una vulnerabilità di protezione, perché è possibile creare una richiesta contenente un nome di file non valido ed estremamente lungo, in modo da produrre due effetti. Innanzitutto, se ritiene che il nome del file debba essere elaborato come parte di un file ASP, l'estensione ISAPI ASP effettua un'inclusione lato server. In secondo luogo, il nome di file può eludere il controllo di sicurezza. Di conseguenza, il nome del file, che è più lungo del buffer destinato a contenerlo, provoca un sovraccarico del buffer durante l'elaborazione del file ASP.

**Quali operazioni consente di eseguire lo sfruttamento della vulnerabilità?**
Un utente che riuscisse a sfruttare la vulnerabilità potrebbe utilizzarla per due scopi:

-   Interruzione di servizi. Sovraccaricando il buffer con dati casuali, l'utente può danneggiare il codice del programma provocando l'interruzione dei servizi IIS sul server.
-   Modifica del funzionamento del server. Sovraccaricando il buffer con dati attentamente selezionati, l'utente può sovrascrivere il codice del programma sul server con del nuovo codice, modificando le funzionalità del server.

**Chi può sfruttare la vulnerabilità?**
Qualsiasi utente in grado di stabilire una sessione con un server Web interessato dalla vulnerabilità potrebbe riuscire a sfruttarla.

**In caso di sfruttamento della vulnerabilità per l'arresto del server IIS, quali operazioni sono necessarie per ripristinare il normale funzionamento?**
In IIS 4.0 è necessario riavviare il servizio IIS. In IIS 5.0 e 5.1, il servizio viene riavviato automaticamente.

**In caso di sfruttamento della vulnerabilità per la modifica del funzionamento del software server, quali operazioni potrebbero essere eseguite?**
Sfruttando la vulnerabilità in questo modo, un utente non autorizzato potrebbe acquisire gli stessi privilegi descritti in precedenza:

-   In IIS 4.0 l'utente potrebbe ottenere il controllo completo del server
-   In IIS 5.0 e 5.1 l'utente potrebbe ottenere i privilegi associati a Web Application Manager, equivalenti a quelli di un utente senza privilegi.

**IIS Lockdown Tool è in grado di proteggere il server?**
È possibile sfruttare questa vulnerabilità soltanto se nel server sono attivate le funzionalità ASP (Active Server Pages). Nella versione 1.0 di IIS Lockdown Tool le funzionalità ASP sono disattivate per impostazione predefinita. La versione corrente dello strumento (2.1) fornisce diversi ruoli server. Selezionando l'opzione Server Web statico, le funzionalità ASP vengono disattivate per impostazione predefinita.

**Lo strumento URLScan è in grado di proteggere il sistema da questa vulnerabilità?**
Pur senza garantire una protezione totale, URLScan è in grado di ridurre notevolmente l'ambito della vulnerabilità. Per impostazione predefinita, URLScan blocca tutti gli URL che contengono dati non-ASCII. Questo blocco non impedisce di provocare l'interruzione del servizio sovraccaricando il buffer con una grande quantità di dati, tuttavia ostacola lo sfruttamento della vulnerabilità per alterare il funzionamento del software server, perché rende necessario creare del codice eseguibile valido utilizzando esclusivamente dati ASCII.

**Come è stata scoperta la vulnerabilità?**
Microsoft ha scoperto questa vulnerabilità durante una revisione dei sistemi di protezione.

**In che modo opera la patch per eliminare la vulnerabilità?**
La patch corregge l'errore di troncamento, impedendo il passaggio degli URL in questione alla funzione.

**Sovraccarico del buffer nella gestione delle intestazioni HTTP (CVE-CAN-2002-0150)**

**Qual è la natura della vulnerabilità?**
Si tratta di una vulnerabilità di [sovraccarico del buffer](http://www.microsoft.com/technet/security/bulletin/glossary.asp) che riguarda IIS 4.0, 5.0 e 5.1. Inviando una particolare richiesta a un server Web, un utente non autorizzato potrebbe provocare l'interruzione di servizi Web o l'esecuzione di programmi sul server. In IIS 4.0, tale programma verrebbe eseguito con privilegi di sistema completi, mentre in IIS 5.0 e 5.1 verrebbe eseguito con privilegi più limitati, ma comunque significativi.
I clienti che hanno utilizzato IIS Lockdown Tool per configurare i server come server Web statici sono già protetti dalla vulnerabilità. Analogamente, l'uso dello strumento URLScan con l'insieme di regole predefinito impedisce di sfruttare la vulnerabilità per ottenere il controllo del server, riducendo l'attacco a un semplice attacco DoS.

**Quali sono le cause della vulnerabilità?**
**La vulnerabilità è dovuta a un errore che si verifica durante l'analisi delle intestazioni HTTP da parte delle funzionalità ASP. Prima di trasferire tali informazioni in un buffer per l'elaborazione, viene eseguito un controllo per verificare che i delimitatori previsti siano presenti e che si trovino nelle posizioni appropriate. È tuttavia possibile eludere il controllo, provocando un sovraccarico del buffer.**

**Che cosa sono le intestazioni HTTP?**
Quando un client invia una richiesta a un server Web, deve fornire a quest'ultimo alcune informazioni specifiche sulla richiesta. Deve ad esempio indicare come sono stati formattati i dati contenuti nella richiesta, qual è il tipo di browser utilizzato dal client, qual è l'azione che deve essere eseguita dal server e così via. Tutte queste informazioni vengono specificate nella richiesta, all'interno di campi che prendono il nome di [intestazioni HTTP](http://msdn.microsoft.com/library/en-us/act/htm/actml_ref_href.asp).

**In che cosa consiste l'errore legato alla modalità con cui IIS gestisce le intestazioni HTTP**
Quando riceve una richiesta HTTP, IIS deve analizzare le intestazioni per interpretarne i dati e intraprendere l'azione appropriata. Durante l'analisi, le intestazioni vengono suddivise nelle varie parti che le compongono, ciascuna delle quali viene collocata in un buffer. IIS riconosce la fine di ogni parte individuando un apposito carattere di delimitazione.
Prima di eseguire l'operazione, IIS verifica che i delimitatori siano effettivamente presenti e che si trovino in posizioni appropriate all'interno della richiesta. Tuttavia, costruendo la richiesta in un determinato modo, è possibile eludere il controllo e indurre IIS a ritenere che i caratteri di delimitazione sono presenti, anche se non lo sono.

**Perché questo produce una vulnerabilità di protezione?**
Lo scopo del controllo è impedire la copia di una quantità di informazioni superiore alla capacità del buffer. Se il controllo viene eluso, questa forma di protezione viene a mancare e si verifica un sovraccarico del buffer.
Si supponga che un utente invii una richiesta le cui intestazioni HTTP contengono grandi quantità di dati. In condizioni normali, IIS rileva l'assenza dei caratteri di delimitazione previsti, deducendo che il contenuto dei campi è eccessivo per poter essere correttamente inserito nei buffer, e respinge la richiesta. Se tuttavia la richiesta viene costruita in modo da sfruttare la vulnerabilità, IIS viene indotto a ritenere che il formato sia corretto e copia i campi nel buffer, provocandone il sovraccarico.

**Quali operazioni consente di eseguire lo sfruttamento della vulnerabilità?**
Un utente che riuscisse a sfruttare la vulnerabilità potrebbe utilizzarla per due scopi.

-   Interruzione di servizi. Sovraccaricando il buffer con dati casuali, l'utente può danneggiare il codice del programma provocando l'interruzione dei servizi IIS sul server.
-   Modifica del funzionamento del server. Sovraccaricando il buffer con dati attentamente selezionati, l'utente può sovrascrivere il codice del programma sul server con del nuovo codice, modificando le funzionalità del software server.

**Chi può sfruttare la vulnerabilità?**
Qualsiasi utente in grado di stabilire una sessione con un server Web interessato dalla vulnerabilità potrebbe riuscire a sfruttarla.

**In caso di sfruttamento della vulnerabilità per l'arresto del server IIS, quali operazioni sono necessarie per ripristinare il normale funzionamento?**
In IIS 4.0 è necessario riavviare il servizio IIS. In IIS 5.0 e 5.1, il servizio viene riavviato automaticamente.

**In caso di sfruttamento della vulnerabilità per la modifica del funzionamento del software server, quali operazioni potrebbero essere eseguite?**
Sfruttando la vulnerabilità in questo modo, un utente non autorizzato potrebbe acquisire gli stessi privilegi descritti in precedenza:

-   In IIS 4.0 l'utente potrebbe ottenere il controllo completo del server
-   In IIS 5.0 e 5.1 l'utente potrebbe ottenere i privilegi associati a Web Application Manager, equivalenti a quelli di un utente senza privilegi.

**IIS Lockdown Tool è in grado di proteggere il server?**
È possibile sfruttare questa vulnerabilità soltanto se nel server sono attivate le funzionalità ASP (Active Server Pages). Nella versione 1.0 di IIS Lockdown Tool le funzionalità ASP sono disattivate per impostazione predefinita. La versione corrente dello strumento, (2.1), fornisce diversi ruoli server. Selezionando l'opzione Server Web statico, le funzionalità ASP vengono disattivate per impostazione predefinita.

**Lo strumento URLScan è in grado di proteggere il sistema da questa vulnerabilità?**
Pur senza garantire una protezione totale, URLScan è in grado di ridurre notevolmente l'ambito della vulnerabilità. Per impostazione predefinita, URLScan blocca tutti gli URL che contengono dati non-ASCII. Questo blocco non impedisce di provocare l'interruzione del servizio sovraccaricando il buffer con una grande quantità di dati, tuttavia ostacola lo sfruttamento della vulnerabilità per alterare il funzionamento del software server, perché rende necessario creare del codice eseguibile valido utilizzando esclusivamente dati ASCII.

**In che modo opera la patch per eliminare la vulnerabilità?**
La patch corregge il meccanismo di controllo e ne garantisce la corretta esecuzione in ogni circostanza.

**Sovraccarico del buffer nell'estensione ISAPI HTR (CVE-CAN-2002-0071)**

**Qual è la natura della vulnerabilità?**
Si tratta di una vulnerabilità di [sovraccarico del buffer](http://www.microsoft.com/technet/security/bulletin/glossary.asp) che riguarda IIS 4.0 e 5.0. Inviando un particolare tipo di richiesta a un server Web affetto da questa vulnerabilità, l'aggressore potrebbe causare una temporanea interruzione dei servizi Web o, più raramente, potrebbe assumere il controllo del server.

-   L'effetto più probabile dello sfruttamento di questa vulnerabilità è dato dall'interruzione del servizio del server Web. Anche se è teoricamente possibile assumere il controllo del server, questo può avvenire solo in circostanze fortuite.
-   Il componente che contiene la vulnerabilità viene rimosso da IIS Lockdown Tool per impostazione predefinita.
-   La configurazione predefinita dello strumento URLScan impedisce lo sfruttamento della vulnerabilità.

**Quali sono le cause della vulnerabilità?**
Questa vulnerabilità è dovuta alla presenza di un errore di off-by-one (che provoca l'allocazione di un buffer più piccolo del necessario di un byte) dell'estensione ISAPI che implementa le caratteristiche di script HTR. Tale errore si verifica durante il calcolo della dimensione di un buffer utilizzato per memorizzare un valore di input. Inviando una richiesta di script HTR contenente particolari errori di formato, è possibile sfruttare l'errore di calcolo per generare un sovraccarico del buffer. Questo può provocare, come minimo, un'interruzione del servizio IIS. Nel peggiore dei casi (difficilmente sfruttabile), può consentire l'esecuzione di codice sul server.

**Che cos'è HTR?**
HTR è una tecnologia di script avanzata di prima generazione, fornita con IIS 2.0. La tecnologia HTR non è mai stata adottata su vasta scala, soprattutto perché in seguito con IIS 4.0 è stata introdotta una tecnologia decisamente superiore, [Active Server Pages](http://msdn.microsoft.com/library/en-us/iisref/html/psdk/asp/iiwawelc.asp) (.ASP), che si è diffusa prima che i clienti avessero investito in HTR risorse di sviluppo significative. Tutte le versioni di IIS, fino alla 5.1, supportano HTR per garantire la compatibilità con le versioni precedenti.
Microsoft consiglia da tempo di disattivare HTR sui server Web, a meno che l'uso di questa tecnologia non sia di importanza critica. IIS Lockdown Tool disattiva il supporto di HTR per impostazione predefinita, eliminando la mappatura dell'estensione ISAPI HTR.

**Esistono ancora molti sistemi che utilizzano la tecnologia HTR?**
Attualmente la tecnologia HTR viene ancora utilizzata quasi esclusivamente per supportare i [servizi di gestione delle password basati sul Web](http://support.microsoft.com/support/kb/articles/q184/6/19.asp). Con IIS viene fornito un insieme di script HTR che, se distribuiti, permettono agli utenti di cambiare le proprie password di Windows NT per mezzo di un server Web e agli amministratori di gestire le password attraverso il Web.
Microsoft consiglia in genere di evitare la gestione delle password attraverso il Web. Se esiste comunque questa esigenza, si consiglia di convertire in formato ASP tutti gli script HTR necessari.

**In che cosa consiste il problema legato all'uso delle estensione ISAPI HTR?**
Quando l'estensione ISAPI HTR riceve una richiesta di esecuzione di uno script, calcola la dimensione del buffer necessario per memorizzare la richiesta. A causa di un errore di calcolo, tuttavia, viene creato un buffer più piccolo di un byte del necessario. Inviando una serie di richieste HTR contenenti particolari errori di formato, un aggressore potrebbe sfruttare la vulnerabilità per sovrascrivere la memoria del server.

**Quali operazioni consente di eseguire lo sfruttamento della vulnerabilità?**
Un utente non autorizzato potrebbe sfruttare la vulnerabilità in due modi diversi. Inviando una serie di richieste che producono semplicemente un sovraccarico del buffer con dati casuali, l'aggressore può causare l'interruzione del servizio. Selezionando accuratamente i dati, è tuttavia possibile (anche se non semplice) modificare il funzionamento del servizio IIS, per indurlo a svolgere le attività desiderate dall'aggressore.

**Se un utente non autorizzato decidesse di sfruttare la vulnerabilità per interrompere il servizio, quali sarebbero le conseguenze?**
Se l'attacco venisse condotto contro un server IIS 4.0, quest'ultimo non sarebbe più in grado di gestire le richieste Web, fino al riavvio del servizio IIS. Se l'attacco venisse condotto contro un server IIS 5.0 o 5.1, l'interruzione sarebbe solo momentanea, perché il servizio IIS viene riavviato automaticamente. In entrambi i casi, tutte le sessioni Web aperte al momento dell'interruzione del servizio verrebbero chiuse.

**Se un utente non autorizzato decidesse di sfruttare la vulnerabilità per modificare il funzionamento del servizio, quali sarebbero le conseguenze?**
Sfruttando la vulnerabilità in questo modo, un utente non autorizzato potrebbe acquisire gli stessi privilegi descritti in precedenza:

-   In IIS 4.0 l'utente potrebbe ottenere il controllo completo del server.
-   In IIS 5.0 l'utente potrebbe ottenere i privilegi associati a Web Application Manager, equivalenti a quelli di un utente senza privilegi.

**È semplice sfruttare la vulnerabilità per assumere il controllo del server?**
Come quelle descritte sopra, anche questa vulnerabilità provoca un sovraccarico dell'heap. Tuttavia, è una delle meno semplici da sfruttare. Ad esempio, da un punto di vista tecnico, è molto più difficile creare uno strumento in grado di sfruttare un sovraccarico dell'heap di un solo byte.
Anche disponendo di uno strumento di questo tipo, sarebbe possibile sfruttare la vulnerabilità solo in determinate condizioni. La maggior parte di queste condizioni si presenta, in pratica, solo se il server non ha ancora soddisfatto alcuna richiesta Web dopo il suo ultimo riavvio. Anche in questo caso, l'aggressore dovrebbe comunque possedere informazioni specifiche sul software in esecuzione nel server. Si noti, tuttavia, che nelle circostanze appropriate, nessuno di questi fattori è impossibile da eliminare.

**Se si esegue IIS Lockdown Tool, esiste comunque un pericolo di vulnerabilità?**
IIS Lockdown Toold isattiva il supporto di HTR per impostazione predefinita. Non è possibile sfruttare questa vulnerabilità in un server in cui il supporto di HTR sia stato disattivato.

**Se si esegue URLScan, esiste comunque un pericolo di vulnerabilità?**
L'insieme di regole predefinito di URLScan impedisce lo sfruttamento di questa vulnerabilità, anche se il server è vulnerabile da altri punti di vista. Si consiglia tuttavia di applicare comunque la patch a tutti i server in cui sia attivato il supporto di HTR, anche se protetti da URLScan.

**Cosa è necessario fare se si utilizza un sistema affetto da questa vulnerabilità?**
La soluzione migliore consiste nel rimuovere completamente il supporto di HTR, eliminando la mappatura dell'estensione ISAPI HTR (il modo più semplice per eseguire questa operazione consiste nell'utilizzare IIS Lockdown Tool). Si consiglia di mantenere il supporto di HTR solo se l'uso di questa tecnologia è di importanza critica.
Si consiglia di applicare la patch anche se il supporto di HTR è stato rimosso. Innanzitutto, perché elimina anche altre vulnerabilità e, in secondo luogo, perché l'applicazione della patch assicura la protezione del server anche se in seguito il supporto di HTR venisse inavvertitamente riattivato.

**In che modo opera la patch per eliminare la vulnerabilità?**
La patch corregge l'errore di calcolo nell'estensione ISAPI HTR, assicurando l'allocazione di un buffer di dimensione appropriata alla richiesta in arrivo

**Violazione di accesso nella gestione degli errori URL (CVE-CAN-2002-0072)**

**Qual è la natura della vulnerabilità?**
Si tratta di una vulnerabilità di tipo [DoS (Denial of Service)](http://www.microsoft.com/technet/security/bulletin/glossary.asp) che riguarda IIS 4.0, 5.0 e 5.1. Sfruttando questa vulnerabilità, un utente non autorizzato potrebbe impedire temporaneamente a un server Web di fornire i servizi.
La vulnerabilità non consente di compromettere i dati nel computer, né di acquisire privilegi sul sistema. Le ricerche finora svolte da Microsoft hanno rivelato che questa vulnerabilità si presenta solo nei sistemi in cui sono installate le estensioni del server di FrontPage (FPSE) o ASP .NET, ma è possibile che venga riscontrata anche in altre condizioni.

**Quali sono le cause della vulnerabilità?**
Questa vulnerabilità è dovuta al fatto che IIS non gestisce correttamente la condizione di errore che si verifica quando uno dei filtri ISAPI installati dalle estensioni del server di FrontPage o da ASP .NET riceve un URL di lunghezza superiore al massimo consentito. Anche se il problema risiede in IIS, e potrebbe pertanto presentarsi anche in casi che richiedono l'uso di altri filtri ISAPI, le ricerche finora svolte da Microsoft non hanno rivelato altre situazioni che danno luogo al problema.

**Che cos'è un filtro ISAPI?**
Come spiegato sopra, un filtro ISAPI è una DLL in grado di estendere le funzionalità di un server Web. Il filtro che genera il problema specifico viene installato dalle estensioni del server di FrontPage e da ASP .NET, ma potrebbero esisterne altri.

**Che cosa sono le estensioni del server di FrontPage?**
Le [estensioni del server di FrontPage](http://msdn.microsoft.com/library/en-us/dnservext/html/fpovrw.asp)(FPSE) sono un insieme di strumenti che è possibile installare in un server Web per consentire al personale autorizzato di gestire il server, aggiungere o modificare il contenuto ed eseguire altre attività.

**Che cos'è ASP .NET?**
[ASP.NET](http://msdn.microsoft.com/library/default.asp?url=/nhp/default.asp?contentid=28000440) è una piattaforma di sviluppo che consente di realizzare applicazioni Web in modo semplice e rapido. La piattaforma ASP .NET può essere pensata come una versione estesa di ASP. Infatti, oltre a supportare direttamente le applicazioni ASP esistenti, offre anche nuove funzionalità avanzate.

**In che cosa consiste l'errore causato dalle estensioni del server di FrontPage e da ASP .NET?**
Questi programmi non causano in realtà alcun errore. Il problema è infatti dovuto alla modalità con cui IIS gestisce un particolare tipo di condizione che può essere generata dai filtri ISAPI. Anche se gli unici filtri ISAPI finora identificati come causa di tale condizione di errore sono associati alle estensioni del server di FrontPage e ad ASP .NET, il problema non è dovuto ai filtri stessi, ma alla modalità di gestione della condizione di errore.
Qual è la condizione di errore in questione e perché provoca l'interruzione del servizio IIS? L'errore si verifica quando uno di questi filtri ISAPI riceve una richiesta contenente un URL che supera la lunghezza massima consentita. In questo caso, il filtro respinge la richiesta e imposta l'URL sul valore Null. La vulnerabilità è dovuta al fatto che IIS tenta di utilizzare tale URL per inviare la risposta al richiedente, provocando una violazione di accesso che porta all'interruzione del servizio IIS.

**Quali operazioni consente di eseguire lo sfruttamento della vulnerabilità?**
Un utente non autorizzato potrebbe decidere di sfruttare la vulnerabilità per causare l'interruzione del servizio IIS. Questo comporterebbe la chiusura di tutte le sessioni in corso e impedirebbe l'apertura di nuove sessioni fino al riavvio del servizio.

**Come potrebbe essere sfruttata questa vulnerabilità?**
Un utente non autorizzato potrebbe sfruttare il problema inviando a un server affetto da questa vulnerabilità un richiesta che deve essere elaborata da uno dei filtri ISAPI menzionati sopra, includendo nella richiesta un URL di lunghezza superiore al massimo consentito dal filtro (se nel sistema fossero installati altri filtri ISAPI in grado di generare la stessa condizione di errore, l'aggressore potrebbe inviare la richiesta a uno qualsiasi di questi filtri.

**Quali operazioni sono necessarie per ripristinare il normale funzionamento?**
In IIS 4.0 è necessario riavviare il servizio. In IIS 5.0 e 5.1, il servizio viene riavviato automaticamente. .

**È possibile ottenere altri privilegi sul server sfruttando questa vulnerabilità?**
No. Questa vulnerabilità consente esclusivamente attacchi DoS (Denial of Service), poiché non offre alcuna possibilità di modificare il contenuto del server, di eseguire operazioni di gestione o di svolgere qualsiasi altra attività.

**Se le estensioni del server di FrontPage non sono installate nel server, esiste comunque un pericolo di vulnerabilità?**
Alcune estensioni del server vengono installate per impostazione predefinita insieme con IIS 4.0, 5.0 e 5.1, mentre altre devono essere installate separatamente. Poiché i filtri ISAPI in questione vengono installati per impostazione predefinita, per eliminare la vulnerabilità è necessario rimuovere esplicitamente le estensioni del server di FrontPage, utilizzando l'icona Installazione applicazioni del Pannello di controllo. Anche dopo aver rimosso le estensioni del server di FrontPage, è necessario ricordare che nel server possono essere installati anche altri filtri ISAPI in grado di generare la condizione di errore che provoca l'interruzione del servizio IIS.

**Se ASP .NET non è installato nel server, esiste comunque un pericolo di vulnerabilità?**
ASP .NET non viene installato insieme con IIS per impostazione predefinita. Tuttavia, anche se ASP .NET non è installato nel sistema, è possibile che lo siano le estensioni del server di FrontPage, come spiegato nel paragrafo precedente.

**In che modo opera la patch per eliminare la vulnerabilità?**
La patch induce IIS a controllare l'URL durante l'elaborazione dell'errore in questione, per evitare che venga utilizzato.

**Attacchi DoS tramite richieste di stato FTP (CVE-CAN-2002-0073)**

**Qual è la natura della vulnerabilità?**
Si tratta di una vulnerabilità di tipo [DoS (Denial of Service)](http://www.microsoft.com/technet/security/bulletin/glossary.asp) che riguarda IIS 4.0, 5.0 e 5.1. Sfruttando questa vulnerabilità, un utente non autorizzato potrebbe impedire temporaneamente a un server Web di fornire i servizi.
La vulnerabilità può essere sfruttata solo se il server Web è configurato per fornire anche servizi FTP. In IIS 4.0 i servizi FTP vengono installati per impostazione predefinita, ma ciò non avviene in IIS 5.0 e 5.1. IIS Lockdown Tool disattiva il supporto di FTP per impostazione predefinita. La vulnerabilità non consente di compromettere i dati nel computer, né di acquisire privilegi sul sistema.

**Quali sono le cause della vulnerabilità?**
Questa vulnerabilità è dovuta al fatto che l'implementazione FTP di IIS 4.0, 5.0 e 5.1 non gestisce correttamente le richieste di stato della connessione, se contengono particolari errori di formattazione. La ricezione di una richiesta di questo tipo provoca pertanto l'interruzione del servizio IIS.

**Che cos'è FTP?**
FTP (File Transfer Protocol) è un protocollo standard, specificato nella [RFC 959](http://www.ietf.org/rfc/rfc959.txt), che permette agli utenti di inviare file o recuperarli da un server. Tutte le versioni di IIS comprendono un'implementazione di questo protocollo.

**In che cosa consiste l'errore nell'implementazione del protocollo FTP di IIS 4.0, 5.0 e 5.1?**
L'implementazione gestisce in modo errato le richieste di stato delle connessioni aperte. Nello specifico, la presenza di determinati caratteri nella richiesta genera una condizione di errore che non viene restituita correttamente al modulo software che ha inviato la richiesta dell'utente. Il modulo chiamante è quindi costretto a utilizzare dati non inizializzati, con una conseguente violazione di accesso.

**Quali operazioni consente di eseguire lo sfruttamento della vulnerabilità?**
Poiché i servizi FTP sono forniti direttamente dal servizio IIS, lo sfruttamento di questa vulnerabilità permette di interrompere anche i servizi Web, oltre ai servizi FTP, provocando la chiusura di tutte le sessioni aperte al momento dell'attacco.

**Chi può sfruttare la vulnerabilità?**
Questa vulnerabilità può essere sfruttata da qualsiasi utente in grado di aprire una sessione FTP presso un server che ne sia affetto. La richiesta di stato contenente l'errore di formattazione può essere inviata solo nell'ambito di una sessione esistente.

**Quali operazioni sono necessarie per ripristinare il normale funzionamento?**
In un server IIS 4.0 è necessario riavviare il servizio IIS. Nei server IIS 5.0 e 5.1, il servizio viene riavviato automaticamente.

**Cosa si intende quando si afferma che l'aggressore deve essere in grado di aprire una sessione presso il server?**
L'aggressore non può semplicemente condurre un attacco pilotato inviando dati al server. Il servizio FTP deve essere attivo e in esecuzione e l'utente non autorizzato deve disporre delle credenziali di accesso oppure il server deve essere configurato per l'accesso anonimo.

**Il servizio FTP viene installato ed eseguito per impostazione predefinita?**
Questo servizio viene attivato ed eseguito per impostazione predefinita in IIS 4.0, ma non in IIS 5.0 e 5.1. È inoltre utile notare che IIS Lockdown Tool disattiva questo servizio per impostazione predefinita.

**Se il servizio FTP è in esecuzione, l'accesso anonimo è attivo per impostazione predefinita?**
**Sì. È sempre opportuno verificare se sia effettivamente necessario consentire l'accesso anonimo al server FTP e, in caso contrario, provvedere a disattivarlo. e.**

**In che modo opera la patch per eliminare la vulnerabilità?**
La patch consente al servizio FTP di gestire correttamente il comando in questione.

**Cross-site scripting della funzione di ricerca dei file della documentazione in linea di IIS, delle pagine di errore HTTP e dei messaggi di reindirizzamento (CVE-CAN-2002-0074, 0075, 0148)**

**Qual è la natura delle vulnerabilità?**
Sono tutte vulnerabilità di tipo cross-site scripting (CSS) e hanno la stessa natura e lo stesso effetto: permettono di inviare a un server che ne sia affetto un richiesta che consente di inviare a un altro utente una pagina Web contenente uno script. Tale script viene eseguito nel browser dell'utente come se provenisse da un sito di terze parti. In questo modo, lo script può utilizzare le impostazioni di protezione del sito Web di terze parti e l'aggressore ha la possibilità di accedere a tutti i dati appartenenti al sito.
Poiché non è possibile inserire il codice dello script in una sessione esistente, questa vulnerabilità può essere sfruttata solo se un utente legittimo apre un messaggio di posta elettronica HTML o visita un sito Web di un utente malintenzionato. In entrambi i casi, la vulnerabilità non può essere sfruttata se l'utente legittimo utilizza Internet Explorer.

**Quali sono le cause della vulnerabilità?**
Alcuni servizi Web forniti da IIS non convalidano correttamente tutti i dati di input, prima di utilizzarli, e possono essere quindi sottoposti a intrusioni Cross-Site Scripting (CSS).

**Che cos'è il Cross-site scripting?**
Cross-Site Scripting è una vulnerabilità di protezione che permette a un eventuale malintenzionato di inserire codice estraneo in una sessione di connessione a un sito Web. A differenza della maggior parte delle vulnerabilità di protezione, il CSS non riguarda solo i prodotti di determinati fornitori, ma può colpire qualsiasi software in esecuzione in un server Web che non adotti una strategia difensiva adeguata. All'inizio del 2000, Microsoft e [CERT](http://www.cert.org/) hanno informato tutte le aziende del settore, per consentire la risoluzione del problema.

**Come funziona il CSS?**
Questo problema è descritto in dettaglio in un documento di riepilogo e nella pagina delle domande frequenti. H. Di seguito viene tuttavia fornita una descrizione sommaria di questo tipo di vulnerabilità. Si consideri un sito Web A, che offre una funzione di ricerca che permette agli utenti di immettere una frase o una parola da cercare. Se l'utente digita la parola "banana", il sito esegue la ricerca, dopodiché visualizza una pagina di errore per informare l'utente che la parola specificata non è stata trovata. Tale pagina di errore viene inviata al browser dell'utente, che la analizza per poi visualizzarla.
Si supponga ora che, al posto della parola "banana", l'utente immetta una stringa di questo tipo: "banana ‹SCRIPT› ‹Alert('Hello');› ‹/SCRIPT›". Se la funzione di ricerca è programmata in modo da accettare qualsiasi frase immessa dall'utente, esegue una ricerca basata sull'intera stringa e restituisce una pagina di errore per informare che non è possibile trovare la frase "banana ‹SCRIPT› ‹Alert('Hello');› ‹/SCRIPT›". Tuttavia, poiché qualsiasi testo compreso fra i tag "‹SCRIPT›" e "‹/SCRIPT›" viene interpretato come codice di programma, durante l'elaborazione della pagina di errore il browser dell'utente visualizza una finestra di dialogo contenente il testo "Hello".
Questo esempio mostra come un utente possa inviare codice a un server Web e fare in modo che venga eseguito nel proprio computer. Questa non è tuttavia una vulnerabilità di protezione. Un malintenzionato potrebbe comunque creare un sito Web in grado di sfruttare la vulnerabilità per eseguire qualsiasi codice nei computer degli utenti che lo visitano. Se ad esempio un malintenzionato fosse in grado di indurre gli utenti a visitare il sito Web B e a fare clic su di un determinato collegamento, questo sito potrebbe accedere al sito Web A, immettere uno script dannoso nella pagina di ricerca e inviarla al server per conto di un visitatore del sito B. La pagina dei risultati verrebbe pertanto restituita all'utente che di fatto ha dato origine alla richiesta, poiché ha fatto clic su quel collegamento, e verrebbe elaborata nel computer di quest'ultimo.

**Che cosa può fare lo script sul computer dell'utente?**
Lo script proveniente dal sito Web B (quello dell'aggressore) verrebbe eseguito sul computer dell'utente come se provenisse dal sito Web A, pertanto:

-   Lo script verrebbe eseguito sul computer del visitatore utilizzando le impostazioni di protezione del sito Web A.
-   Lo script proveniente dal sito Web B sarebbe in grado di accedere ai cookie e a qualsiasi altra informazione appartenente al sito Web A disponibile nel sistema dell'utente.

**Le possibili conseguenze dipendono dal tipo di browser utilizzato?**
No. In questo caso il problema dipende dal software del sito Web, non dal browser. La vulnerabilità potrebbe presentarsi ogni volta che il software del server Web utilizza l'input dell'utente senza effettuare alcuna verifica, mentre dovrebbe utilizzare un filtro per rifiutare le stringhe non appropriate. Nell'esempio precedente, il motore di ricerca dovrebbe estrarre dalla stringa tutti i caratteri che potrebbero introdurre uno script nel processo di ricerca, quali "&lt;" e "&gt;". L'elenco completo dei caratteri da escludere è riportato nell'articolo [Q252985](http://www.microsoft.com/technet/support/kb.asp?id=252985) della Knowledge Base.

**Qual è il problema causato da IIS?**
IIS fornisce tre servizi che non filtrano correttamente l'input e che potrebbero, pertanto, essere utilizzati per un attacco di cross-site scripting. I servizi in questione sono:

-   Una funzionalità che permette di eseguire ricerche nella documentazione in linea di IIS. Poiché questa funzionalità è disponibile solo in IIS 5.0 e 5.1, questa vulnerabilità interessa solo tali versioni.
-   Il messaggio restituito quando l'utente richiede una pagina Web la cui posizione è stata modificata (questo messaggio prende il nome di [risposta di reindirizzamento](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/iisref/html/psdk/asp/devs3v72.asp)). La vulnerabilità interessa i messaggi restituiti da IIS 4.0, 5.0 e 5.1. Tuttavia, gli attacchi basati su questi messaggi possono riuscire solo se il destinatario utilizza un browser diverso da Internet Explorer.
-   Molti messaggi di errore restituiti quando l'utente invia una richiesta di pagina Web che produce un errore. La vulnerabilità interessa le versioni predefinite dei messaggi restituiti da IIS 4.0 e 5.0.

**Quali operazioni consente di eseguire lo sfruttamento di queste vulnerabilità?**
Un malintenzionato che gestisca un sito Web e che riesca a indurre un utente a fare clic su di un collegamento di tale sito potrebbe sfruttare la vulnerabilità per condurre un attacco di cross-site scripting attraverso un altro sito Web basato su IIS. Come spiegato in precedenza, l'aggressore potrebbe eseguire uno script nel browser del visitatore utilizzando le impostazioni di protezione del sito Web basato su IIS per accedere ai cookie e ad altre informazioni appartenenti a tale sito.

**Perché è possibile sfruttare queste vulnerabilità solo se il visitatore utilizza un browser diverso da Internet Explorer?**
Nel caso del messaggio di errore restituito quando la pagina Web richiesta è stata spostata, Internet Explorer non visualizza il testo del messaggio di errore, ma elabora le altre informazioni contenute nella risposta del server, in modo da reindirizzare immediatamente il visitatore sulla pagina appropriata. Non è quindi possibile sfruttare l'errore per un'intrusione di cross-site scripting. Altri browser potrebbero comportarsi diversamente, a seconda di come implementano la gestione delle risposte di reindirizzamento.

**È possibile sfruttare questa vulnerabilità per danneggiare un sito Web?**
No. L'aggressore non può intraprendere alcuna azione contro il sito di terze parti, ma può servirsene per attaccare i computer dei suoi visitatori.

**In precedenza si è affermato che l'aggressore può eseguire uno script nel browser del visitatore utilizzando le impostazioni di sicurezza di un sito Web di terze parti. Quali vantaggi può trarre l'aggressore da questa possibilità?**
Dipende dalle aree di protezione a cui appartengono il sito Web dell'aggressore e quello di terze parti.

-   Se appartengono entrambi alla stessa area (tutti i siti appartengono all'area Internet per impostazione predefinita, a meno che l'utente non decida di modificarla), sono soggetti alle stesse restrizioni di protezione e l'aggressore non può trarre alcun vantaggio dalla vulnerabilità.
-   Se l'utente ha collocato il sito dell'aggressore in un'area con restrizioni superiori, rispetto al sito di terze parti, lo script dell'aggressore ha la possibilità di eseguire sul computer dell'utente tutte le operazioni consentite agli script del sito di terze parti.
-   Se il visitatore ha collocato il sito di terze parti in un'area con restrizioni superiori, rispetto a quella del sito dell'aggressore, quest'ultimo perderebbe parte delle proprie capacità, nel corso dell'attacco.

Occorre tuttavia ricordare che, indipendentemente dalle impostazioni di protezione, lo script dell'aggressore ha comunque la possibilità di accedere ai cookie e a tutte le altre informazioni appartenenti al sito di terze parti disponibili nel sistema del visitatore. Dal punto di vista del browser, infatti, l'intrusione proviene dal sito di terze parti.

**In che modo opera la patch per eliminare la vulnerabilità?**
La patch elimina la vulnerabilità imponendo a tutti i servizi indicati sopra di filtrare correttamente le informazioni di input prima di utilizzarle.

Disponibilità della patch
-------------------------

<span></span>
**Indirizzi per il download della patch**

-   Microsoft IIS 4.0:
    [http://www.microsoft.com/Downloads/Release.asp?ReleaseID=37931](http://www.microsoft.com/downloads/release.asp?releaseid=37931%20)
-   Microsoft IIS 5.0:
    [http://www.microsoft.com/Downloads/Release.asp?ReleaseID=37824](http://www.microsoft.com/downloads/release.asp?releaseid=37824%20)
-   Microsoft IIS 5.1:
    [http://www.microsoft.com/Downloads/Release.asp?ReleaseID=37857](http://www.microsoft.com/downloads/release.asp?releaseid=37857)

#### Ulteriori informazioni sulla patch

**Piattaforme supportate**

-   La patch per IIS 4.0 può essere installata nei sistemi che eseguono Windows NT 4.0 con [Service Pack 6a](http://www.microsoft.com/ntserver/nts/downloads/recommended/sp6/allsp6.asp).
-   La patch per IIS 5.0 può essere installata nei sistemi che eseguono Windows 2000 con [Service Pack 1](http://www.microsoft.com/windows2000/downloads/servicepacks/sp1/default.asp) oppure [Service Pack 2](http://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.asp).
-   La patch per IIS 5.1 può essere installata nei sistemi che eseguono Windows XP Professional [Gold](http://www.microsoft.com/windowsxp/default.asp).

**Inserimento nelle prossime versioni dei Service Pack**

-   Per Windows NT 4.0 non è previsto il rilascio di altri Service Pack.
-   Le correzioni relative ad IIS 5.0 verranno inserite in Windows 2000 Service Pack 3.
-   Le correzioni relative ad IIS 5.1 verranno inserite in Windows XP Service Pack 1.

**Riavvio del sistema**

-   IIS 4.0: per evitare il riavvio del sistema, è possibile interrompere il servizio IIS, installare la patch con l'opzione /z e riavviare il servizio. Ulteriori informazioni su questa procedura sono disponibili nell'articolo Q319733 della Knowledge Base.
-   IIS 5.0: No.
-   IIS 5.1: non richiesto. Se viene visualizzata una finestra di dialogo che chiede di riavviare il sistema per completare l'installazione della patch, è possibile ignorare la richiesta.

**Patch sostituite**

-   IIS 4.0 e 5.0: questa patch sostituisce quella fornita nel Comunicato di protezione Microsoft MS01-044 (la precedente patch cumulativa per IIS 4.0 e 5.0, che sostituisce tutte le altre patch).
-   IIS 5.1: No

**Verifica dell'installazione della patch**

IIS 4.0:

-   Per verificare che la patch sia installata nel computer, controllate che sia stata creata la seguente chiave del Registro di sistema:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\Q319733

-   Per verificare l'installazione dei singoli file, consultare il file manifest contenuto nell'articolo Q319733 della Knowledge Base.

IIS 5.0:

-   Per verificare che la patch sia installata nel computer, controllate che sia stata creata la seguente chiave del Registro di sistema:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q319733.

-   Per controllare i singoli file, utilizzate le informazioni su versione, data e ora contenute nella seguente chiave del Registro di sistema:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q319733\\Filelist.

IIS 5.1:

-   Per verificare che la patch sia installata nel computer, controllate che sia stata creata la seguente chiave del Registro di sistema:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q319733.

-   Per controllare i singoli file, utilizzate le informazioni su versione, data e ora contenute nella seguente chiave del Registro di sistema:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q319733\\Filelist.

**Attenzione**

1.  Le correzioni riguardanti le vulnerabilità dei server IIS 4.0 non sono incluse nella patch, perché non richiedono la modifica del software, ma azioni amministrative. Oltre ad applicare la patch, è necessario eseguire le azioni amministrative descritte nei seguenti comunicati:
    -   Comunicato di protezione Microsoft [MS00-028](http://technet.microsoft.com/security/bulletin/ms00-028)
    -   Comunicato di protezione Microsoft [MS00-025](http://technet.microsoft.com/security/bulletin/ms00-025)
    -   Comunicato di protezione Microsoft [MS99-025](http://technet.microsoft.com/security/bulletin/ms99-025) (che riprende i problemi trattati nel comunicato [MS98-004](http://technet.microsoft.com/security/bulletin/ms98-004))
    -   Comunicato di protezione Microsoft [MS99-013](http://technet.microsoft.com/security/bulletin/ms99-013)
2.  La patch non contiene correzioni per le vulnerabilità riguardanti prodotti che non fanno parte di IIS, come le estensioni del server di FrontPage e Index Server, anche se tali prodotti sono strettamente legati ad IIS e vengono in genere installati nei server IIS. Al momento della stesura di questo documento, tali vulnerabilità erano descritte nei seguenti comunicati:

    -   Comunicato di protezione Microsoft [MS01-043](http://technet.microsoft.com/security/bulletin/ms01-043)
    -   Comunicato di protezione Microsoft [MS01-025](http://technet.microsoft.com/security/bulletin/ms01-025)
    -   Comunicato di protezione Microsoft [MS00-084](http://technet.microsoft.com/security/bulletin/ms00-084)
    -   Comunicato di protezione Microsoft [MS00-018](http://technet.microsoft.com/security/bulletin/ms00-018)
    -   Comunicato di protezione Microsoft [MS00-006](http://technet.microsoft.com/security/bulletin/ms00-006)

    Esiste tuttavia un'eccezione. La correzione relativa alla vulnerabilità di Index Server descritta nel comunicato di protezione Microsoft MS01-033 è infatti inclusa in questa patch a causa della gravità del problema per i server IIS.

3.  Prima di installare in IIS 4.0 questa patch, o qualsiasi altra patch di protezione, è necessario verificare di aver seguito l'ordine di installazione corretto. In particolare, è necessario verificare che Windows NT 4.0 Service Pack 6a sia stato applicato (o riapplicato) dopo l'installazione del servizio IIS 4.0.
4.  Se si utilizza Site Server, è necessario tenere presente che un errore precedentemente documentato, riguardante alcuni errori occasionali di autenticazione, interessa anche questa e alcune altre patch. L'articolo [Q317815](http://support.microsoft.com/default.aspx?scid=kb;en-us;q317815) della Knowledge Base fornisce una descrizione del problema con la relativa soluzione.

**Localizzazione:**

Le versioni localizzate della patch sono disponibili sui siti indicati nella sezione "Disponibilità della patch".

**Altre patch di protezione:**

Sui siti Web elencati di seguito, sono disponibili anche patch che risolvono altri problemi di protezione:

-   Le patch di protezione sono disponibili sul sito [Microsoft Download Center](http://www.microsoft.com/downloads/search.asp?search=keyword&value='security_patch'&opsysid=1), e possono essere trovate facilmente eseguendo una ricerca basata sulle parole chiave "security patch".
-   Le patch per le piattaforme consumer sono disponibili sul sito [Windows Update](http://windowsupdate.microsoft.com/).
-   Tutte le patch offerte dal sito [Windows Update](http://windowsupdate.microsoft.com/) sono disponibili anche in formato ridistribuibile sul sito Windows Update Corporate site.

#### Ulteriori informazioni:

**Ringraziamenti**

Microsoft [ringrazia](http://technet.microsoft.com/security/bulletin/policy) tutti coloro che hanno collaborato alla segnalazione e alla risoluzione del problema, contribuendo coSi alla sicurezza dei clienti:

-   eEye Digital Security (<http://www.eeye.com>), per avere segnalato il sovraccarico del buffer nell'implementazione della codifica Chunked ASP.
-   Entrust Technologies (<http://www.entrust.com>), per avere segnalato il sovraccarico del buffer relativo alla gestione delle intestazioni HTTP.
-   Chris Wysopal di @Stake (<http://www.atstake.com>) e Peter Grundl di KPMG, per avere segnalato il sovraccarico del buffer nell'estensione ISAPI HTR e la violazione di accesso nella gestione degli errori URL.
-   Joe Smith (jsm1th@hotmail.com) e zenomorph (admin@cgisecurity.com) di <http://www.lac.co.jp/security/>, per avere segnalato la vulnerabilità di cross-site scripting nella funzionalità di ricerca della documentazione in linea di IIS.
-   Keigo Yamazaki del team LAC SNS (<http://www.lac.co.jp/security/>), per avere segnalato la vulnerabilità di cross-site scripting relativa al reindirizzamento dei messaggi di risposta.
-   Thor Larholm di Jubii A/S, per avere segnalato la vulnerabilità di cross-site scripting relativa alle pagine di errore HTTP.

**Supporto:**

-   L'articolo Q319733 della Microsoft Knowledge Base, che contiene una descrizione del problema, sarà disponibile entro 24 ore dalla pubblicazione del presente comunicato. Il sito Web del Supporto tecnico Microsoft consente di eseguire ricerche tra gli articoli della Knowledge Base.
-   Per assistenza tecnica, è possibile contattare il Supporto tecnico Microsoft. Il supporto per le chiamate relative alle patch di protezione viene fornito gratuitamente.

Risorse per la sicurezza: l'area dedicata alla sicurezza del sito Web [Microsoft TechNet](http://www.microsoft.com/italy/technet/security/default.mspx) offre tutte le informazioni necessarie per la protezione dei prodotti Microsoft.

**Revisioni:**

-   V1.0 (10 Aprile 2002): Creazione comunicato
-   V1.1 (12 Aprile 2002): Aggiornamento comunicato per aggiungere la nota che i sistemi con IIS 4.0 non richiedono il riavvio dopo l'installazione della patch
-   V1.2 (12 Aprile 2002): Aggiornamento per informazioni su autenticazione di Site Server

*Built at 2014-04-18T01:50:00Z-07:00*
